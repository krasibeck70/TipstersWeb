@using Microsoft.AspNet.Identity
@model Tipsters.Models.Models.ApplicationUser
@**@

@section Styles{
    <link href=@Url.Content("~/Content/Profile.css") rel="stylesheet" />
<link href=@Url.Content("~/Content/tips.css") rel="stylesheet" />
}
@section scripts
{
    <script>
        $('.btn-vote').click(function () {
            var tip_id = $(this).data("tip");
            console.log(tip_id);
            var url = "/Tips/VotesTips/";
            var parameter = "";
            if ($(this).hasClass('Up')) {
                var clicks = parseInt(this.innerHTML.split(";")[1]);
                clicks += 1;
                this.innerHTML = "&nbsp;" + clicks;
                parameter = 'Up';
            } else {
                var clicks1 = parseInt(this.innerHTML.split(";")[1]);
                clicks1 += 1;
                this.innerHTML = "&nbsp;" + clicks1;
                parameter = 'Down';
            }
            console.log(parameter);

            $.ajax({
                type: "POST",
                url: url + tip_id + "¿" + parameter,
            }
            );
        })
    </script>
}
@{
    ViewBag.Title = "Profile";
}

<div class="container profile">
    <div class="row">
        <div class="span12 text-center">
            <div class="well well-small clearfix">
                <div class="row-fluid">
                    <div class="span2">
                        @if (string.IsNullOrEmpty(Model.Image))
                        {
                            <img src="~/Content/Images/avatar.png" class="img-polaroid" />
                        }
                        else
                        {
                            <img src="~/Content/Images/@Model.Image" class="img-polaroid" />
                        }
                        
                        <br/>
                        <br/>
                        <div>
                            @if (User.Identity.GetUserId() == Model.Id)
                            {
                                using (Html.BeginForm("Profile", "Users", FormMethod.Post, new {enctype = "multipart/form-data"}))
                                {
                                    <div style="height: 0px; overflow: hidden">
                                        <input type="file" id="files" name="file" onchange="this.form.submit()"/>
                                    </div>
                                    <div>
                                        <input type="button" OnClick="chooseFile();" class="btn btn-primary" value="Select Image"/>
                                    </div>
                                    <script>
                                        function chooseFile() {
                                            $("#files").click();
                                        }
                                    </script>
                                }
                            }

                        </div>


                    </div>
                    <div class="span4">
                        <h2>@Model.FirstUsername</h2>
                        <ul class="unstyled">
                            <li><i class="icon-envelope"></i><strong>@Model.Email</strong> </li>
                            <li><i class="icon-globe"></i><strong>@Model.BirthDate.Value.Day-@Model.BirthDate.Value.Month-@Model.BirthDate.Value.Year</strong> </li>
                            @*@foreach (var user in Model.OwnerFollowers)
                            {
                                <li><i class="icon-globe"></i> @user.FullName</li>
                            }*@
                        </ul>
                    </div>
                    <div class="span6">
                        <ul class="inline stats">
                            <li>
                                <span style="color: black">@Model.OwnerPronostics.Count</span>
                                Tips
                            </li>
                            <li>
                                <span style="color: black">@Model.OwnerFollowers.Count</span>
                                Followers
                            </li>

                            @*<li>
                                <span>@Model.CountFollowed</span>
                                Followed
                            </li>*@
                        </ul>
                        <div>
                            <!--/span6-->
                        </div><!--/row-->
                    </div>
                    <!--Body content-->
                </div>
            </div>

            <div class="row">
                <div class="col-10 text-center">
                    @foreach (var tip in Model.OwnerPronostics)
                    {
                        <div id="customJumbotron" class="jumbotron">
                            <div class="pull-left col-3 text-center">
                                <button class="btn btn-success"><strong>@tip.User.Email</strong></button>
                            </div>
                            <div class="pull-right col-3 text-center">
                                <span id="TimeElapsed" class="btn btn-warning"><strong>@tip.TimeAgoPronostic</strong></span>
                            </div>
                            <div class="col-4 col-lg-offset-1 text-center">
                                <span class="btn btn-primary"><strong>@tip.LocalTeam vs @tip.AwayTeam</strong></span>
                            </div>
                            <div class="jumbotron">
                                <div class="col-3 pull-left">
                                    <span><strong>Type Of Tip:</strong></span>
                                    <span class="btn btn-info">@tip.TypeOfPrognise</span>
                                </div>
                                <div class="col-3 pull-right">
                                    <span><strong>Start Match:</strong></span>
                                    @{
                                        if (tip.StartMatch.Day == DateTime.Now.Day && tip.StartMatch.Month == DateTime.Now.Month)
                                        {
                                            <span class="btn btn-info">Today @tip.StartMatch.ToString($"HH:mm:ss")</span>
                                        }
                                        else if (tip.StartMatch.Day == DateTime.Now.Day + 1)
                                        {
                                            <span class="btn btn-info">Tomorrow @tip.StartMatch.ToString($"HH:mm:ss")</span>
                                        }
                                        else
                                        {
                                            <span class="btn btn-info">@tip.StartMatch.ToString($"dd-MM-yyyy HH:mm:ss")</span>
                                        }
                                    }
                                </div>
                                <br>
                                <br>
                                <div class="col-3 pull-left">
                                    <span><strong>Odds:</strong></span>
                                    <span class="btn btn-info">@tip.Koeficent</span>
                                </div>
                                <div class="col-3 pull-right">
                                    <button type="button" data-val="@tip.VotesUp" data-tip="@tip.Id" class="btn btn-success glyphicon glyphicon-thumbs-up Up btn-vote">&nbsp; @tip.VotesUp</button>
                                    <button type="button" data-val2="@tip.VotesDown" data-tip="@tip.Id" class="btn btn-success glyphicon glyphicon-thumbs-down Down btn-vote">&nbsp; @tip.VotesDown</button>
                                </div>
                                <br>
                                <br>
                                <br>
                                <div class="col-12">
                                    <div class="progress">
                                        <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="@tip.PercentageWin" aria-valuemin="0" aria-valuemax="100" style="width:@tip.PercentageWin%">@tip.PercentageWin%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>



